
{% block userbar %}
  <!-- Thimble user bar for homepage and project list -->
  <nav class="navbar-thimble container-flex">
    <div id="navbar-left" class="container-flex">
      <div class="navbar-logo-container">
        <a href="/{{ locale }}" class="logo">
          <img src="/img/thimble-logo.svg" class="thimble-logo-full">
        </a>
      </div>
    </div>

    <div id="navbar-right" class="container-flex">

      <div id="navbar-locale" class="nav-chunk">
        <div class="dropdown">
          <div class="dropdown-toggle">
            {{ languages[locale].nativeName }}
            <img class="icon-arrow-down" src="/img/icon/dropdown-arrow.svg">
          </div>
          <div class="dropdown-content">
            <ul class="language-list">
              {% for langCode, obj in languages %}
                <li><a {% if langCode == locale %} class="selected" {% endif %} target="_self" href="/{{ langCode }}{{ URL_PATHNAME }}">{{ obj.nativeName }}</a></li>
              {% endfor %}
            </ul>
            <!-- We're going to disable this for now until we figure out where to link this to
            <p class="bottom-message">
              Don't see your language? <a href="#">Help add it.</a>
            </p>
            -->
          </div>
        </div>
      </div>

      <div id="navbar-login" class="{% if username %}signed-in{% endif %} nav-chunk" >
        <div id="navbar-login-inner">
        {% if username %}
          <div id="navbar-logged-in" class="dropdown">
            <div class="dropdown-toggle">
              <img class="avatar" src="{{avatar}}">
              {{ gettext("loginWelcome") | instantiate }}
              <img class="icon-arrow-down" src="/img/icon/dropdown-arrow.svg" />
            </div>

            <div class="dropdown-content">
              <ul class="dropdown">
                <li>
                  <a id="new-project-link" href="/{{ locale }}/projects/new">
                    <img src="/img/icon/new-project.svg" />
                    {{ gettext("newProjectLink") }}
                  </a>
                </li>
                <li>
                  <div class="dropdown-submenu ">
                    <div class="dropdown-submenu-toggle">
                      <img src="/img/icon/your-projects.svg" />
                      {{ gettext("yourProjectsLink") }}
                    </div>
                    <div class="dropdown-submenu-content">
                      <ul  id="project-list" data-username="{{ username }}"  class="dropdown-submenu">
                        {% for project in projects %}
                          <li class="project bramble-user-project"
                          id="{{ [ 'project', project.id ] | join('-') }}"
                          {% for key, value in project %}
                          {{ [ "data", "project", key ] | join("-") }}="{{ value }}"
                          {% endfor %}
                          >
                            <a class="edit-link" target="_self" href="/{{locale}}/user/{{username}}/{{project.id}}/{{queryString}}">
                              <span class="project-name">{{project.title}}</span>
                              </a>
                          </li>
                        {% endfor %}
                        <li class="project">
                          <a href="/{{ locale }}/projects/{{ queryString }}" target="_self">
                            View More
                          </a>
                        </li>
                      </ul>
                      <script src="/scripts/vendor/require.min.js"
                          data-main="/{{ localeDir }}/editor/scripts/project-list.js">
                      </script>
                    </div>
                  </div>
                </li>
                <li>
                  <a href="{{ logoutURL }}" id="logout-link" target="_self">
                    <img src="/img/icon/sign-out.svg" />
                    {{ gettext("signOutLink") }}
                  </a>
                </li>
              </ul>
            </div>
        {% else %}
          <div id="navbar-anonymous">
            {{ gettext("signInPromptHomepage") | instantiate | safe }}
          </div>
        {% endif %}
        </div>
      </div>
    </div>
  </nav>
{% endblock %}

